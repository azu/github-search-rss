{
    "version": "https://jsonfeed.org/version/1",
    "title": "npm/rfcs Issues",
    "home_page_url": "https://azu.github.io/github-search-rss/npm-rfcs.json",
    "feed_url": "https://azu.github.io/github-search-rss/npm-rfcs.json",
    "description": "npm/rfcs Issues on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/96741774?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a href=\"https://github.com/npm/rfcs/blob/15b6a18dd8615a958a6f8051a7737b08a93c20e9/accepted/0000-staged-packages.md\">https://github.com/npm/rfcs/blob/15b6a18dd8615a958a6f8051a7737b08a93c20e9/accepted/0000-staged-packages.md</a></p>",
            "url": "https://github.com/0839829821/hello-github-actions/issues/12",
            "title": "thaiwab111@gmail.com",
            "date_modified": "2022-01-05T10:11:22.000Z",
            "date_published": "2022-01-05T10:11:16.000Z",
            "author": {
                "name": "0839829821",
                "url": "https://github.com/0839829821"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/899988?u=1a682cd39f51bb0224a52c7640a040c849b73ae8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">One thing that is missing from <a href=\"https://overreacted.io/npm-audit-broken-by-design/\" rel=\"nofollow\">https://overreacted.io/npm-audit-broken-by-design/</a> is a link to a proper bug report.</p>\n<p dir=\"auto\">I see <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1033027026\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/cli/issues/3930\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/cli/issues/3930/hovercard\" href=\"https://github.com/npm/cli/issues/3930\">npm/cli#3930</a> that was closed (!!!) because it was being discussed at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"955062192\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/422\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/npm/rfcs/pull/422/hovercard\" href=\"https://github.com/npm/rfcs/pull/422\">npm/rfcs#422</a></p>\n<p dir=\"auto\">Like THAT would even partially solve ongoing severe bug.</p>\n<p dir=\"auto\">Maybe also mention that they close bug reports under pretext that it is discussed somewhere?</p>",
            "url": "https://github.com/gaearon/overreacted.io/issues/751",
            "title": "Link to \"npm audit is a security theater\" bug report",
            "date_modified": "2022-01-12T04:21:01.000Z",
            "date_published": "2022-01-12T04:19:35.000Z",
            "author": {
                "name": "matkoniecz",
                "url": "https://github.com/matkoniecz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/61999?u=95b1beb82e9dd2f0428f9e51f605dfeeca253a4e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Bug description</h2>\n<p dir=\"auto\"><code>LogFormatter</code> isn’t exported from Logger module so I can’t extend the class like in the doc.</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/61999/147972756-671823d9-ed9f-49b6-949f-ba1f03ff06ed.png\"><img src=\"https://user-images.githubusercontent.com/61999/147972756-671823d9-ed9f-49b6-949f-ba1f03ff06ed.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>\n<h3 dir=\"auto\">Expected Behavior</h3>\n<p dir=\"auto\">I can import <code>LogFormatter</code></p>\n<h3 dir=\"auto\">Current Behavior</h3>\n<p dir=\"auto\">The class isn't exported</p>\n<h3 dir=\"auto\">Possible Solution</h3>\n<ol dir=\"auto\">\n<li>Import it from</li>\n<li>Ensure that all our tests import classes from package root</li>\n</ol>\n<h3 dir=\"auto\">Steps to Reproduce</h3>\n<ol dir=\"auto\">\n<li>Add `import {LogFormatter} from \"@aws-lambda-powertools/logger\"</li>\n<li>Yoru IDE will show syntax error.</li>\n</ol>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li><strong>Powertools version used</strong>: 0.2.0-beta.15</li>\n<li><strong>Packaging format (Layers, npm)</strong>: npm</li>\n<li><strong>AWS Lambda function runtime:</strong> N/A</li>\n<li><strong>Debugging logs:</strong> N/A</li>\n</ul>\n<h3 dir=\"auto\">Related issues, RFCs</h3>\n<p dir=\"auto\">N/A</p>",
            "url": "https://github.com/awslabs/aws-lambda-powertools-typescript/issues/393",
            "title": "fix(logger): LogFormatter isn't exported from Logger module so users cannot use custom formatter feature",
            "date_modified": "2022-01-03T19:50:30.000Z",
            "date_published": "2022-01-03T19:42:47.000Z",
            "author": {
                "name": "ijemmy",
                "url": "https://github.com/ijemmy"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2502070?u=cd880252899aaef411c4dc1aeb19bf9ba5f71e2e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n\n\n\n<h2 dir=\"auto\">Bug description</h2>\n\n<p dir=\"auto\">When I add the powertools to my project, it adds dependency to <code>fsevents</code>. On my Mac, running <code>npm install</code> defines the platform <code>darwin</code> for <code>fsevents</code>. The CI build run in CodeBuild and Linux. The build fails because the platfrom doesn't match.</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\n\nnpm ERR! notsup Unsupported platform for fsevents@2.3.2: wanted {&quot;os&quot;:&quot;darwin&quot;} (current: {&quot;os&quot;:&quot;linux&quot;,&quot;arch&quot;:&quot;x64&quot;})\n--\n51 | npm ERR! notsup Valid OS:    darwin\n52 | npm ERR! notsup Valid Arch:  undefined\n53 | npm ERR! notsup Actual OS:   linux\n54 | npm ERR! notsup Actual Arch: x64\"><pre><code>\n\nnpm ERR! notsup Unsupported platform for fsevents@2.3.2: wanted {\"os\":\"darwin\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n--\n51 | npm ERR! notsup Valid OS:    darwin\n52 | npm ERR! notsup Valid Arch:  undefined\n53 | npm ERR! notsup Actual OS:   linux\n54 | npm ERR! notsup Actual Arch: x64\n</code></pre></div>\n\n<p dir=\"auto\">I want to develop on my Mac and still be able to use Linux in CI.</p>\n<h3 dir=\"auto\">Expected Behavior</h3>\n\n<p dir=\"auto\">Npm should install all dependencies on both platforms.</p>\n<h3 dir=\"auto\">Current Behavior</h3>\n\n<p dir=\"auto\">See above. <code>fsevent</code> seems to use features of a specific operating system. Thus, I can't develop on my machine while using Linux in CI.</p>\n<h3 dir=\"auto\">Possible Solution</h3>\n\n<h3 dir=\"auto\">Steps to Reproduce</h3>\n\n\n<ol dir=\"auto\">\n<li>npm install powertools on mac</li>\n<li>add <code>package.json</code> and <code>package-lock.json</code>, commit and push</li>\n<li>checkout code on a Linux machine</li>\n<li>rum <code>npm ci</code></li>\n</ol>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li><strong>Powertools version used</strong>: 0.2.0</li>\n<li><strong>Packaging format (Layers, npm)</strong>: npm</li>\n<li><strong>AWS Lambda function runtime:</strong></li>\n<li><strong>Debugging logs:</strong></li>\n</ul>\n<h3 dir=\"auto\">Related issues, RFCs</h3>\n\n\n",
            "url": "https://github.com/awslabs/aws-lambda-powertools-typescript/issues/421",
            "title": "bug(all): Remove dependency to fsevents",
            "date_modified": "2022-01-06T17:13:41.000Z",
            "date_published": "2022-01-06T13:10:58.000Z",
            "author": {
                "name": "timohirt",
                "url": "https://github.com/timohirt"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/10476006?u=4ace4d1e847581e5d7816a67a21f6f3285599d4d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n\n\n\n<h2 dir=\"auto\">Bug description</h2>\n\n<p dir=\"auto\">In example-function.MyFunction and example-function.MyFunctionWithDecorator<br>\nline 9: const metrics = new Metrics({ namespace: namespace, service: serviceName });<br>\nservice should be serviceName</p>\n<p dir=\"auto\">In example-function.MyFunctionWithDecorator<br>\ntypo in line 14 @tracer.captureLambdaHanlder() should be @tracer.captureLambdaHandler()</p>\n\n<h3 dir=\"auto\">Expected Behavior</h3>\n<p dir=\"auto\">Try out the examples</p>\n\n<h3 dir=\"auto\">Current Behavior</h3>\n<p dir=\"auto\">problems in IDE</p>\n\n<h3 dir=\"auto\">Possible Solution</h3>\n<p dir=\"auto\">correct the lines; see summary</p>\n\n<h3 dir=\"auto\">Steps to Reproduce</h3>\n<p dir=\"auto\">See summary</p>\n\n\n<ol dir=\"auto\">\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li><strong>Powertools version used</strong>: 0.02</li>\n<li><strong>Packaging format (Layers, npm)</strong>:</li>\n<li><strong>AWS Lambda function runtime:</strong> N/A</li>\n<li><strong>Debugging logs:</strong></li>\n</ul>\n<h3 dir=\"auto\">Related issues, RFCs</h3>\n\n\n",
            "url": "https://github.com/awslabs/aws-lambda-powertools-typescript/issues/435",
            "title": "bug: CDK examples (metrics & tracer) have outdated references",
            "date_modified": "2022-01-08T11:02:12.000Z",
            "date_published": "2022-01-06T20:47:42.000Z",
            "author": {
                "name": "mhboon",
                "url": "https://github.com/mhboon"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1225809?u=014dfa27d8cd49cc1e92615be849f6929ceadedc&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Description of the feature request</h2>\n<p dir=\"auto\">Integrations tests are not ran automatically.</p>\n<p dir=\"auto\">We should automate integration tests run in github actions (and update CONTRIBUTING.md accordingly) to increase trust in our release process and move towards continuous release.</p>\n<p dir=\"auto\">Today you can run integ tests in each package by</p>\n<ol dir=\"auto\">\n<li>exporting your credentials AWS</li>\n</ol>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\nexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nexport AWS_DEFAULT_REGION=us-west-2\"><pre><code>export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\nexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nexport AWS_DEFAULT_REGION=us-west-2\n</code></pre></div>\n<ol dir=\"auto\">\n<li><code>cd packages/myModule</code></li>\n<li><code>npm run test:e2e</code></li>\n</ol>\n<h3 dir=\"auto\">Related issues, RFCs</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3743529\" data-permission-text=\"Title is private\" data-url=\"https://github.com/awslabs/aws-lambda-powertools-typescript/discussions/315\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/awslabs/aws-lambda-powertools-typescript/discussions/315/hovercard\" href=\"https://github.com/awslabs/aws-lambda-powertools-typescript/discussions/315\">#315</a></p>",
            "url": "https://github.com/awslabs/aws-lambda-powertools-typescript/issues/418",
            "title": "chore: automate integration test run",
            "date_modified": "2022-01-06T11:08:02.000Z",
            "date_published": "2022-01-06T09:53:03.000Z",
            "author": {
                "name": "flochaz",
                "url": "https://github.com/flochaz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/542108?u=2c20c6b8a5298ef8cccf5e4cf0013bae865d0dc7&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Based on the RRFC proposal: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"956265356\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/423\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/423/hovercard\" href=\"https://github.com/npm/rfcs/issues/423\">npm/rfcs#423</a></p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Add <code>pkg-format-*</code> and <code>json-format-*</code> configs</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Add <code>npm pkg format</code> and <code>npm pkg format-validate</code> commands</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Rules for implicit editing of json, creating, new json, and outputting <code>--json</code> (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"956265356\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/423\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/423/hovercard?comment_id=901339248&amp;comment_type=issue_comment\" href=\"https://github.com/npm/rfcs/issues/423#issuecomment-901339248\">npm/rfcs#423 (comment)</a>)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Rules for reading config values (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"956265356\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/423\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/423/hovercard?comment_id=901339248&amp;comment_type=issue_comment\" href=\"https://github.com/npm/rfcs/issues/423#issuecomment-901339248\">npm/rfcs#423 (comment)</a>)</li>\n</ul>",
            "url": "https://github.com/npm/statusboard/issues/384",
            "title": "npm pkg format and json formatting",
            "date_modified": "2021-08-31T17:59:54.000Z",
            "date_published": "2021-08-25T16:44:31.000Z",
            "author": {
                "name": "lukekarrys",
                "url": "https://github.com/lukekarrys"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/105728?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><strong>Describe the bug</strong><br>\nNPM package setting configurations don't work with Node 8. GroupId is no longer passed through from package.json to the generated package</p>\n<p dir=\"auto\"><strong>To Reproduce</strong><br>\nSteps to reproduce the behavior:</p>\n<ol dir=\"auto\">\n<li>Set the <code>groupId</code> in package.json</li>\n<li>Run aem-packager</li>\n<li>Observe the contents of the generated package</li>\n</ol>\n<p dir=\"auto\"><strong>Expected behavior</strong><br>\nGroupId is passed through</p>\n<p dir=\"auto\"><strong>Screenshots and Logs</strong></p>\n<p dir=\"auto\"><strong>Environment (please complete the following information):</strong></p>\n<ul dir=\"auto\">\n<li>OS: OSX</li>\n<li>Version: Monterey</li>\n<li>NodeJS Version: v16.13.0</li>\n<li>NPM Version: v8.1.0</li>\n</ul>\n<p dir=\"auto\"><strong>Additional context</strong><br>\nStarting in NPM 8 (possibly NPM 7? but that's not a LTS version) the variables in <code>process.env</code> that are namespaced <code>npm_package_</code> are no longer available. The only one passed through is <code>npm_package_version</code>. Other expected ones like <code>npm_package_aem-packager_groupId</code> are no longer available, presumably for security reasons. See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1048071157\" data-permission-text=\"Title is private\" data-url=\"https://github.com/amclin/aem-packager/issues/385\" data-hovercard-type=\"issue\" data-hovercard-url=\"/amclin/aem-packager/issues/385/hovercard\" href=\"https://github.com/amclin/aem-packager/issues/385\">#385</a></p>\n<p dir=\"auto\">Needs some research to identify the preferred method of passing these variables in newer NPM and if this breaks the various methods currently supported for providing configurations to aem-packager<br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"800407442\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/cli/issues/2609\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/cli/issues/2609/hovercard\" href=\"https://github.com/npm/cli/issues/2609\">npm/cli#2609</a><br>\n<a href=\"https://github.com/npm/rfcs/blob/main/implemented/0021-reduce-lifecycle-script-environment.md\">https://github.com/npm/rfcs/blob/main/implemented/0021-reduce-lifecycle-script-environment.md</a></p>",
            "url": "https://github.com/amclin/aem-packager/issues/395",
            "title": "groupId doesn't work in NPM 7 and 8",
            "date_modified": "2022-01-12T15:46:44.000Z",
            "date_published": "2022-01-11T16:30:51.000Z",
            "author": {
                "name": "amclin",
                "url": "https://github.com/amclin"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/936006?u=c104316e137de4ced56ccab44d1167a386c95271&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Is there an existing issue for this?</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I have searched the existing issues</li>\n</ul>\n<h3 dir=\"auto\">This issue exists in the latest npm version</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> I am using the latest npm</li>\n</ul>\n<h3 dir=\"auto\">Current Behavior</h3>\n<ul dir=\"auto\">\n<li>run <code>npm i</code>  inside of a workspace folder, instead of updating the top-level package-lock a new one is created. This is the wrong behaviour for workspaces.</li>\n</ul>\n<p dir=\"auto\">I understand that this can be \"fixed\" by only running said command at the top-level but it's not ideal as its too-easy of a mistake to <code>npm i</code> on a package instead and end up committing the new package-lock.</p>\n<p dir=\"auto\">I feel Yarn's handling of this reduces potential bugs by detecting a workspace then updating the top-level package-lock.json only</p>\n<h3 dir=\"auto\">Expected Behavior</h3>\n<p dir=\"auto\">package-lock is generated inside of <code>project-a</code> folder (including a node_modules)</p>\n<h3 dir=\"auto\">Steps To Reproduce</h3>\n<ul dir=\"auto\">\n<li>Clone <a href=\"https://github.com/jasonwilliams/npm-workspace-testcase\">https://github.com/jasonwilliams/npm-workspace-testcase</a></li>\n<li>Follow instructions within readme</li>\n</ul>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li>npm: v8.3.0</li>\n<li>Node.js: v17.3.0</li>\n<li>OS Name: Windows (WSL)</li>\n<li>System Model Name:</li>\n<li>npm config:</li>\n</ul>\n<div class=\"highlight highlight-source-ini position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"; node bin location = /home/jasew/.nvm/versions/node/v17.3.0/bin/node\n; cwd = /home/jasew/workspace/npm-testcase/project-a\n; HOME = /home/jasew\n; Run `npm config ls -l` to show all defaults.\"><pre><span class=\"pl-c\"><span class=\"pl-c\">;</span> node bin location = /home/jasew/.nvm/versions/node/v17.3.0/bin/node</span>\n<span class=\"pl-c\"><span class=\"pl-c\">;</span> cwd = /home/jasew/workspace/npm-testcase/project-a</span>\n<span class=\"pl-c\"><span class=\"pl-c\">;</span> HOME = /home/jasew</span>\n<span class=\"pl-c\"><span class=\"pl-c\">;</span> Run `npm config ls -l` to show all defaults.</span></pre></div>\n<p dir=\"auto\">RFC: <a href=\"https://github.com/npm/rfcs/blob/main/implemented/0026-workspaces.md\">https://github.com/npm/rfcs/blob/main/implemented/0026-workspaces.md</a></p>",
            "url": "https://github.com/npm/cli/issues/4226",
            "title": "[BUG] workspace is not respected when updating package deps",
            "date_modified": "2022-01-09T14:03:45.000Z",
            "date_published": "2022-01-09T14:00:51.000Z",
            "author": {
                "name": "jasonwilliams",
                "url": "https://github.com/jasonwilliams"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/91213?u=c5d308beaf78f91744200e6507109f04ad881503&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Review and iterate on Pure Mode RFC</p>\n<p dir=\"auto\">Pure Mode RFC PR: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"976903615\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/436\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/npm/rfcs/pull/436/hovercard\" href=\"https://github.com/npm/rfcs/pull/436\">npm/rfcs#436</a></p>\n<p dir=\"auto\">Recent RFC: <a href=\"https://github.com/npm/rfcs/blob/70e9e1ece367b86f21e8afaae8ad7a950ba8011d/accepted/0000-pure-mode.md\">https://github.com/npm/rfcs/blob/70e9e1ece367b86f21e8afaae8ad7a950ba8011d/accepted/0000-pure-mode.md</a></p>",
            "url": "https://github.com/npm/cli/issues/3679",
            "title": "Pure Mode RFC",
            "date_modified": "2021-08-23T18:46:40.000Z",
            "date_published": "2021-08-23T18:46:33.000Z",
            "author": {
                "name": "fritzy",
                "url": "https://github.com/fritzy"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7319147?u=73ad191b147c6b7951979056b07f711ccfdc3a81&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Hello,</p>\n<p dir=\"auto\">because of RFC21 : <a href=\"https://github.com/npm/rfcs/blob/latest/implemented/0021-reduce-lifecycle-script-environment.md\">https://github.com/npm/rfcs/blob/latest/implemented/0021-reduce-lifecycle-script-environment.md</a></p>\n<p dir=\"auto\"><code>npm_package_*</code> are no longer exported in the environment variables</p>\n<p dir=\"auto\">No idea what the fix should be</p>\n<p dir=\"auto\">Thanks for the hard and awesome work on this!</p>",
            "url": "https://github.com/testdouble/scripty/issues/93",
            "title": "Options won't work with npm >= 7",
            "date_modified": "2021-12-03T16:07:13.000Z",
            "date_published": "2021-02-26T17:37:32.000Z",
            "author": {
                "name": "FredericEspiau",
                "url": "https://github.com/FredericEspiau"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/143668?u=d452964b279d8eedb1d4d3918a4749b887d6532a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/bnb/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/bnb\">@bnb</a> created an npm RFC PR after a recent RFC meeting. With their permission, I am sharing that issue here.</p>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"955062192\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/422\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/npm/rfcs/pull/422/hovercard\" href=\"https://github.com/npm/rfcs/pull/422\">npm/rfcs#422</a></p>",
            "url": "https://github.com/openjs-foundation/pkg-vuln-collab-space/issues/8",
            "title": "Raising awareness of an npm RFC PR",
            "date_modified": "2021-07-30T20:45:49.000Z",
            "date_published": "2021-07-28T17:34:53.000Z",
            "author": {
                "name": "joesepi",
                "url": "https://github.com/joesepi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/810398?u=d8067c4f8624dbdd9eec964cb62059cacafefe42&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h1 dir=\"auto\">Before Opening Please...</h1>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Search for an existing/duplicate RRFC which might be relevant to your RRFC</li>\n</ul>\n<h2 dir=\"auto\">Motivation (\"The Why\")</h2>\n<p dir=\"auto\">Please see detailed description in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3591121\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/discussions/462\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/npm/rfcs/discussions/462/hovercard\" href=\"https://github.com/npm/rfcs/discussions/462\">#462</a>, but tl;dr I'd like npm to \"natively\" support installing a package workspace's <code>npm pack</code>'d artifact into an app workspace's local node_modules folder for production deployment without a bunch of extra prerelease/registry rigmarole. In a sense treat the monorepo/workspace root as a kind of ephemeral local registry</p>\n<h3 dir=\"auto\">Example</h3>\n<p dir=\"auto\">A monorepo with three workspaces, two apps \"a\" and \"b\", one package \"c\". Apps \"a\" and \"b\" depend on package \"c\", and are deployed to different locations (Docker, AWS Lambda, Google Cloud Functions, etc). Following best practices, minimizing build tooling, and wanting to ship a lean, production-only, app artifact, I'd like to an app structure like this (the dist folder is just meant to represent some production-ready code, this is just to show a folder structure that expresses the relationship between packages):</p>\n<div class=\"highlight highlight-source-shell position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ tree apps/a --dirsfirst\napps/a\n├── dist\n├── node_modules\n│   └── @my\n│       └── c\n│           ├── dist\n│           └── package.json\n└── package.json\"><pre>$ tree apps/a --dirsfirst\napps/a\n├── dist\n├── node_modules\n│   └── @my\n│       └── c\n│           ├── dist\n│           └── package.json\n└── package.json</pre></div>\n<p dir=\"auto\">With this structure I'd zip the apps/a folder and push it to AWS, or <code>COPY</code> it into a Docker image in my Dockerfile, etc.</p>\n<h3 dir=\"auto\">How</h3>\n<h4 dir=\"auto\">Current Behaviour</h4>\n<p dir=\"auto\">This structure can be roughly achieved by running these commands:</p>\n<div class=\"highlight highlight-source-shell position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"npm pack -w @my/c\nnpm pack -w @my/c --pack-destination=apps/a\nnpm i my-c-1.0.0.tgz -w @my/a\nrm my-c-1.0.0.tgz apps/a/my-c-1.0.0.tgz\"><pre>npm pack -w @my/c\nnpm pack -w @my/c --pack-destination=apps/a\nnpm i my-c-1.0.0.tgz -w @my/a\nrm my-c-1.0.0.tgz apps/a/my-c-1.0.0.tgz</pre></div>\n<p dir=\"auto\"><strong>Note:</strong></p>\n<p dir=\"auto\">I'm not sure why it's necessary to pack it twice, but something about running <code>npm i my.tgz -w @my/a</code> needs the tarball to exist in both the root and the workspace. Maybe a separate bug about resolving install paths when <code>-w</code> is set?</p>\n<p dir=\"auto\">Also worth noting this changes apps/a/package.json's <code>\"@my/c\"</code> dependency from <code>\"^1.0.0\"</code> to <code>\"file:my-c-1.0.0.tgz\"</code> which I have to immediately undo in order to maintain the dev-time hoisted dependency functionality I want.</p>\n<h4 dir=\"auto\">Desired Behaviour</h4>\n<p dir=\"auto\">Allow a way to specify that <code>npm install</code> and/or <code>npm ci</code> should look to the workspaces in the current monorepo before reaching out to a registry. If a match is found call <code>npm pack</code> on that workspace and \"serve\" the resultant tarball (or its contents). Some suggestions for what this'd look like in the cli:</p>\n<ol dir=\"auto\">\n<li><code>npm i --only=prod --prefer-workspaces -w @my/a</code></li>\n<li><code>npm i --only=prod --prefer-local -w @my/a</code></li>\n<li><code>npm i --only=prod --registry=file:///. -w @my/a</code>\n<ul dir=\"auto\">\n<li>this one's definitely the weirdest, it'd require npm to detect that the \"registry\" at that file URI is a monorepo/workspace-root, but has the advantage of not adding a new flag to the cli, and maybe being configurable via .npmrc?</li>\n</ul>\n</li>\n</ol>\n<p dir=\"auto\">It should work for <code>npm ci</code> as well.</p>\n<h3 dir=\"auto\">References</h3>\n<ul dir=\"auto\">\n<li>Initial discussion: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3591121\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/discussions/462\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/npm/rfcs/discussions/462/hovercard\" href=\"https://github.com/npm/rfcs/discussions/462\">#462</a></li>\n<li>Why I think Lerna doesn't already solve this use case: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3591121\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/discussions/462\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/npm/rfcs/discussions/462/hovercard?comment_id=1380842\" href=\"https://github.com/npm/rfcs/discussions/462#discussioncomment-1380842\">#462 (comment)</a></li>\n<li>Why I think file/folder references are also unsatisfactory: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3591121\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/discussions/462\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/npm/rfcs/discussions/462/hovercard?comment_id=1380544\" href=\"https://github.com/npm/rfcs/discussions/462#discussioncomment-1380544\">#462 (reply in thread)</a></li>\n</ul>",
            "url": "https://github.com/npm/rfcs/issues/463",
            "title": "[RRFC] Multi-app Monorepo Support",
            "date_modified": "2021-11-03T17:52:30.000Z",
            "date_published": "2021-09-24T16:54:46.000Z",
            "author": {
                "name": "mysterycommand",
                "url": "https://github.com/mysterycommand"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509375?u=55f776984d12b256ee7bb30aa105fc726ecfcb50&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Is there an existing issue for this?</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"922624082\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/399\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/399/hovercard\" href=\"https://github.com/npm/rfcs/issues/399\">npm/rfcs#399</a><br>\n<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"863953382\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/372\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/372/hovercard?comment_id=848129245&amp;comment_type=issue_comment\" href=\"https://github.com/npm/rfcs/issues/372#issuecomment-848129245\">npm/rfcs#372 (comment)</a></p>\n<h3 dir=\"auto\">Current Behavior</h3>\n<p dir=\"auto\"><code>npm audit fix --json</code> produces a summary with numbers of items added/removed/updated etc.</p>\n<h3 dir=\"auto\">Expected Behavior</h3>\n<p dir=\"auto\"><code>npm audit fix --json</code> returns enough information to deduce:</p>\n<ul dir=\"auto\">\n<li>dependency tree path (in any reasonable form)</li>\n<li>package name (could be included in path)</li>\n<li>advisory id</li>\n<li>(nice to have) was it a breaking version bump</li>\n</ul>\n<p dir=\"auto\">So that npm-audit-resolver and other tools could keep track of what has been fixed:<br>\n\"1754|cssnano&gt;cssnano-preset-default&gt;postcss-svgo&gt;svgo&gt;css-select&gt;css-what\": {<br>\n\"decision\": \"fix\",<br>\n\"madeAt\": 1625857145332<br>\n},</p>\n<h3 dir=\"auto\">Steps To Reproduce</h3>\n<ol dir=\"auto\">\n<li>npm init -y</li>\n<li>npm i lodash@4.17.0</li>\n<li>npm audit fix --json</li>\n</ol>\n<h3 dir=\"auto\">Environment</h3>\n<ul dir=\"auto\">\n<li>OS: any</li>\n<li>Node: any</li>\n<li>npm: 7</li>\n</ul>",
            "url": "https://github.com/npm/cli/issues/3531",
            "title": "[BUG] npm audit fix is not returning the arborist diff",
            "date_modified": "2021-07-09T19:04:38.000Z",
            "date_published": "2021-07-09T19:01:28.000Z",
            "author": {
                "name": "naugtur",
                "url": "https://github.com/naugtur"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/33400198?u=e09180311ac8eecd08148457c8c87f2353e8c3a6&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/lxieyang/chrome-extension-boilerplate-react/blob/7ac523aea439a5399fa8311dfe57f7a4d0121ae9/webpack.config.js#L129\">chrome-extension-boilerplate-react/webpack.config.js</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 129\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/lxieyang/chrome-extension-boilerplate-react/commit/7ac523aea439a5399fa8311dfe57f7a4d0121ae9\">7ac523a</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L129\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"129\"></td>\n          <td id=\"LC129\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-c1\">description</span>: <span class=\"pl-s1\">process</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">env</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">npm_package_description</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p dir=\"auto\">according to <a href=\"https://github.com/npm/rfcs/blob/latest/implemented/0021-reduce-lifecycle-script-environment.md\">https://github.com/npm/rfcs/blob/latest/implemented/0021-reduce-lifecycle-script-environment.md</a></p>\n<blockquote>\n<p dir=\"auto\">Remove npm_package* values from the script lifecycle environment.</p>\n</blockquote>",
            "url": "https://github.com/lxieyang/chrome-extension-boilerplate-react/issues/53",
            "title": "process.env.npm_package_description is no more available with npm v7",
            "date_modified": "2021-05-25T02:30:50.000Z",
            "date_published": "2021-05-25T02:30:50.000Z",
            "author": {
                "name": "smallfont00",
                "url": "https://github.com/smallfont00"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/43198?u=4e88d47bc79d87f09f463582681d29f1ed6f478e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This is a meta-issue to track various different requests related to publishing that will require a new API.  Feel free to add any I've missed!</p>\n<ul dir=\"auto\">\n<li>New method to uploading the crate payload: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"513670008\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/crates-io-cargo-teams/issues/57\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/crates-io-cargo-teams/issues/57/hovercard\" href=\"https://github.com/rust-lang/crates-io-cargo-teams/issues/57\">#57</a>. (Primarily for timeouts?)</li>\n<li>Some sort of feedback to know when the crate is successfully added to the index.  I'm not sure if this is possible without polling from Cargo.</li>\n<li>Pre-flight validation <em>before</em> uploading and <em>before</em> building the crate.\n<ul dir=\"auto\">\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"244100695\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/cargo/issues/4300\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/cargo/issues/4300/hovercard\" href=\"https://github.com/rust-lang/cargo/issues/4300\">rust-lang/cargo#4300</a> — keyword validation</li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"445765563\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/crates-io-cargo-teams/issues/41\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/crates-io-cargo-teams/issues/41/hovercard\" href=\"https://github.com/rust-lang/crates-io-cargo-teams/issues/41\">#41</a> — Aligning validation (would be much easier if it was all server-side).</li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"614391092\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/cargo/issues/8221\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/cargo/issues/8221/hovercard\" href=\"https://github.com/rust-lang/cargo/issues/8221\">rust-lang/cargo#8221</a> — Check email validation before uploading.</li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"205928219\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/cargo/issues/3662\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/cargo/issues/3662/hovercard\" href=\"https://github.com/rust-lang/cargo/issues/3662\">rust-lang/cargo#3662</a> — Another early validation request.</li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"369360295\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/crates.io/issues/1515\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/crates.io/issues/1515/hovercard\" href=\"https://github.com/rust-lang/crates.io/issues/1515\">rust-lang/crates.io#1515</a> — \"dry run\" validation</li>\n</ul>\n</li>\n<li>Publishing multiple crates at once, atomically (either all \"pass\" or all \"fail\").\n<ul dir=\"auto\">\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"54282864\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/cargo/issues/1169\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/cargo/issues/1169/hovercard\" href=\"https://github.com/rust-lang/cargo/issues/1169\">rust-lang/cargo#1169</a> — <code>publish --all</code></li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\">See also:</p>\n<ul dir=\"auto\">\n<li>Tangential notes on publish API: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"370403863\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/crates.io/issues/1522\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rust-lang/crates.io/issues/1522/hovercard\" href=\"https://github.com/rust-lang/crates.io/issues/1522\">rust-lang/crates.io#1522</a></li>\n</ul>\n<p dir=\"auto\"><strong>Prior art</strong></p>\n<ul dir=\"auto\">\n<li>npm is proposing a \"staged\" publish model where the packages are actually published, but gated with a <code>--staged</code> flag, until a manual step is performed to \"approve\" the publish: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"553729996\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/92\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/npm/rfcs/pull/92/hovercard\" href=\"https://github.com/npm/rfcs/pull/92\">npm/rfcs#92</a>.  Could be interesting to consider!\n<ul dir=\"auto\">\n<li>A similar request for an \"approval\" step: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"644467242\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rust-lang/rfcs/issues/2947\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rust-lang/rfcs/pull/2947/hovercard?comment_id=648871616&amp;comment_type=issue_comment\" href=\"https://github.com/rust-lang/rfcs/pull/2947#issuecomment-648871616\">rust-lang/rfcs#2947 (comment)</a></li>\n</ul>\n</li>\n</ul>",
            "url": "https://github.com/rust-lang/crates-io-cargo-teams/issues/82",
            "title": "New publish API",
            "date_modified": "2021-12-31T16:22:35.000Z",
            "date_published": "2020-05-08T16:49:34.000Z",
            "author": {
                "name": "ehuss",
                "url": "https://github.com/ehuss"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22435660?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Motivation (\"The Why\")</h2>\n<p dir=\"auto\">Today (10/22/21), <a href=\"https://github.com/faisalman/ua-parser-js/issues/536\" data-hovercard-type=\"issue\" data-hovercard-url=\"/faisalman/ua-parser-js/issues/536/hovercard\">ua-parser-js was maliciously compromised</a>, a package with millions of downloads per week. The npm team responded quickly, but there was a 4-hour window where many people could have been affected. This includes those with with a <code>package-lock.json</code> if they were modifying dependencies. This RRFC aims to put an end to compromised transitive dependencies.</p>\n<h2 dir=\"auto\">\"The How\"</h2>\n<p dir=\"auto\">I propose that npm implements a new feature called \"Approved package lists\" (name of course up for discussion). This would be an entirely opt-in feature for teams where security is critical. Here's how it works:</p>\n<ul dir=\"auto\">\n<li>The npm package manager is now aware of a new special file, <code>package-approvals.json</code>. This would live along side <code>package.json</code> and <code>package-lock.json</code>. It would be excluded from files published to the registry on <code>npm publish</code>.</li>\n<li>This file would have the following structure (for the initial version):</li>\n</ul>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    version: number,\n    packages: {\n        [&lt;package-name&gt;]: string[],\n    },\n    extends?: string; // file path or URL\n}\"><pre><code>{\n    version: number,\n    packages: {\n        [&lt;package-name&gt;]: string[],\n    },\n    extends?: string; // file path or URL\n}\n</code></pre></div>\n<p dir=\"auto\">In each array associated with the package, there would be a string of version numbers, e.g. <code>['1.0.0', '1.1.9', '2.3.4']</code>. Importantly, there would be <strong>no</strong> support for ranges of versions.</p>\n<ul dir=\"auto\">\n<li>A number of commands would be added to the npm cli, such as <code>npm approve &lt;package-name&gt;@&lt;version&gt;</code>, <code>npm unapprove &lt;package-name&gt;@&lt;version&gt;</code>, and <code>npm approve --all-current-packages</code>. The <code>npm approve --all-current-packages</code> would have a Yes/No prompt to confirm this choice.</li>\n<li>The <code>package.json</code> file would support a new key: <code>approvals?: string</code>. This optional key could either be a relative/absolute path to a file with the <code>package-approvals.json</code> structure or a URL to retrieve the file.</li>\n</ul>\n<p dir=\"auto\">The idea behind the above proposal would be to change how <code>npm install</code>/<code>npm ci</code> works, and would apply to workspaces. On install, if npm would resolve a package (including transitive packages) but the package version does not exist in the approvals list, npm would error. Importantly, this would occur before any files are written to disk and package scripts (e.g. <code>postinstall</code>) are run. The error could include a list of all packages that don't satisfy the approvals. Developers could resolve this error by running <code>npm approve &lt;package-name&gt;@&lt;version&gt;</code> for a single one, or (if they are really sure their current dependencies are safe), run <code>npm approve --all-current-packages</code>. These convenience scripts would modify the local <code>package-approvals.json</code> file.</p>\n<p dir=\"auto\">Developers would be able to leverage this new file by guaranteeing that they never use an un-audited dependency. Each team of developers could perform their own audit of the dependencies they wish to use, then add each one to the approvals list. This could be a time consuming task, but worth it. To alleviate some of the burden, this file could be hosted somewhere accessible by the internet, so teams or individuals could share their configuration via the <code>approvals</code> <code>package.json</code> field. Additionally, the <code>package-approvals.json</code> has an <code>extends</code> field that could resolve and recursively extend other <code>package-approvals.json</code> files. Obviously there are too many npm packages to have a single community-hosted <code>package-approvals.json</code> file for everyone, but the community could create shared ones for different use-cases.</p>\n<h3 dir=\"auto\">Example</h3>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    version: 1,\n    extends: 'https://example.com/path/to/some/package-approvals.json',\n    packages: {\n        lodash: ['4.17.19', '4.17.21'],\n        react: ['16.0.8', '17.0.2'],\n        // and many more\n    },\n}\"><pre><code>{\n    version: 1,\n    extends: 'https://example.com/path/to/some/package-approvals.json',\n    packages: {\n        lodash: ['4.17.19', '4.17.21'],\n        react: ['16.0.8', '17.0.2'],\n        // and many more\n    },\n}\n</code></pre></div>\n<p dir=\"auto\">I feel that something like this would greatly improve security in the npm community. Please let me know what you think, or if there is a similar RRFC like this already.</p>",
            "url": "https://github.com/npm/rfcs/issues/480",
            "title": "[RRFC] Approved package lists",
            "date_modified": "2021-10-25T09:20:20.000Z",
            "date_published": "2021-10-23T02:01:33.000Z",
            "author": {
                "name": "johndiiorio",
                "url": "https://github.com/johndiiorio"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/23253540?u=cfc48b14ef528db2c98423c36548efbdd0ea0008&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/23253540/146678508-48e8fa8a-835f-4735-b9ab-c04d540c108b.png\"><img src=\"https://user-images.githubusercontent.com/23253540/146678508-48e8fa8a-835f-4735-b9ab-c04d540c108b.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>\n<h2 dir=\"auto\">背景</h2>\n<p dir=\"auto\">在 <a href=\"https://www.zhihu.com/question/493891614/answer/2268212740\" rel=\"nofollow\">2022 前端技术领域会有哪些新的变化？</a> 话题中我曾回答到，越来越多的项目会开始使用 pnpm。</p>\n<blockquote>\n<p dir=\"auto\">这是我正在推动的一件事，使用 pnpm 替换现在的 yarn 。无论是 csr 、ssr、monorepos 等类型项目都正在进行中，有近 10个项目已经迁移完成。<br>\n当时 yarn 的 pnp 特性出来的时候，观望过一阵子，没有大面积火起来，遂放弃 ...<br>\n现在是注意到 vite、modernjs 等使用了 pnpm，其设计理念与node_modules的目录结构也能让业务更加快速安全，所以决定开始全面使用 pnpm。</p>\n</blockquote>\n<p dir=\"auto\">下面记录与分享一下最近使用 pnpm 遇到的问题与解决的过程~</p>\n<h2 dir=\"auto\"><g-emoji class=\"g-emoji\" alias=\"white_check_mark\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/2705.png\">✅</g-emoji> 已解决的问题</h2>\n<h3 dir=\"auto\">jest 单测运行失败</h3>\n<ul dir=\"auto\">\n<li>问题描叙: 使用 pnpm 后，原有的 jest 单测失败了</li>\n<li>问题解决: jest 低版本不支持软链接, 升级 jest 大于等于 25.2.0 版本即可</li>\n<li>报错信息:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/23253540/146667443-8fe7609d-8659-4973-8566-c04d2f9d4778.png\"><img src=\"https://user-images.githubusercontent.com/23253540/146667443-8fe7609d-8659-4973-8566-c04d2f9d4778.png\" alt=\"ca958dffa2ef75ad06f068262b471a7ea952fc25\" style=\"max-width: 100%;\"></a></li>\n<li>问题分析:\n<ol dir=\"auto\">\n<li>根据报错的堆栈找到报错的包，发现其 packge.json dependencies 字段明确声明了依赖的 @xxx/fetch 的版本。但是从报错的信息看，实际运行测试时 import 的却是错误的版本了!</li>\n<li>这里就需要思考一下 jest 是如何运行一个单测用例。如果是简单的 node xxx.test.js 运行一个单测那就不会有上面引用到错误版本依赖的问题，因为按照 node require 模块的规则是不会解析出错。</li>\n<li>让我们回头看一个简单的 jest 单测用例，可以大胆推测一下每个 describe 或者是 it 语句就是一个单独的沙盒环境。如果简单的运行 node xxx.test.js 那就只会存在一个沙盒环境，所有的测试用例会共用一个上下文，这样明显不利于 jest 每个单测隔离的原则</li>\n<li>所以我们初步判断 jest 会自己创建若干个沙盒环境去运行对应的测试代码。而用户的 src 待测试的代码在 jest 看来会通过 fs.readFileSync 去获取到内容字符串，然后不同类型文件经过 babelTransform 或者 tsTransform 得到 js 代码，最后通过 vm 或者 eval, new Function 这样去运行。</li>\n<li>所以说代码中的 import require 等语句的路径是 jest 去静态分析补充完整的，低版本的 jest resolve 不支持软链接是完全有可能的，所以我们顺着 jest 的发版日志，找到最近支持软链接的版本问题解决。</li>\n<li>同理 nextjs 等项目如果有问题也需要找到最近支持软链接的版本进行升级</li>\n</ol>\n</li>\n</ul>\n<div class=\"highlight highlight-source-js position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"// Copyright 2004-present Facebook. All Rights Reserved.\n\n'use strict';\n\njest.useFakeTimers();\n\ndescribe('timerGame', () =&gt; {\n  beforeEach(() =&gt; {\n    jest.spyOn(global, 'setTimeout');\n  });\n  it('waits 1 second before ending the game', () =&gt; {\n    const timerGame = require('../timerGame');\n    timerGame();\n\n    expect(setTimeout).toBeCalledTimes(1);\n    expect(setTimeout).toBeCalledWith(expect.any(Function), 1000);\n  });\n\n  it('calls the callback after 1 second via runAllTimers', () =&gt; {\n    const timerGame = require('../timerGame');\n    const callback = jest.fn();\n\n    timerGame(callback);\n\n    // At this point in time, the callback should not have been called yet\n    expect(callback).not.toBeCalled();\n\n    // Fast-forward until all timers have been executed\n    jest.runAllTimers();\n\n    // Now our callback should have been called!\n    expect(callback).toBeCalled();\n    expect(callback).toBeCalledTimes(1);\n  });\n});\"><pre><span class=\"pl-c\">// Copyright 2004-present Facebook. All Rights Reserved.</span>\n\n<span class=\"pl-s\">'use strict'</span><span class=\"pl-kos\">;</span>\n\n<span class=\"pl-s1\">jest</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">useFakeTimers</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n<span class=\"pl-en\">describe</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'timerGame'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-en\">beforeEach</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-s1\">jest</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">spyOn</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">global</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'setTimeout'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-en\">it</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'waits 1 second before ending the game'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">timerGame</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">require</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'../timerGame'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-s1\">timerGame</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">setTimeout</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeCalledTimes</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">setTimeout</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeCalledWith</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">expect</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">any</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Function</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">1000</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n  <span class=\"pl-en\">it</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'calls the callback after 1 second via runAllTimers'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">timerGame</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">require</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'../timerGame'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">callback</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">jest</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fn</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n    <span class=\"pl-s1\">timerGame</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">callback</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n    <span class=\"pl-c\">// At this point in time, the callback should not have been called yet</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">callback</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">not</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeCalled</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n    <span class=\"pl-c\">// Fast-forward until all timers have been executed</span>\n    <span class=\"pl-s1\">jest</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">runAllTimers</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n    <span class=\"pl-c\">// Now our callback should have been called!</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">callback</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeCalled</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n    <span class=\"pl-en\">expect</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">callback</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toBeCalledTimes</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></pre></div>\n<h3 dir=\"auto\">node-gyp rebuild failures</h3>\n<ul dir=\"auto\">\n<li>问题描叙: 使用 pnpm 后，项目中依赖的 Node.js C++ 插件 rebuild 失败</li>\n<li>问题解决: pnpm 低版本 bug，升级 pnpm 大于等于 6.23.1 版本即可，相关 issue <a href=\"https://github.com/pnpm/pnpm/issues/2135\" data-hovercard-type=\"issue\" data-hovercard-url=\"/pnpm/pnpm/issues/2135/hovercard\">issues/2135</a></li>\n<li>报错信息:</li>\n</ul>\n<div class=\"highlight highlight-source-shell position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"# pnpm i better-sqlite3\nPackages: +11\n+++++++++++\nResolving: total 11, reused 11, downloaded 0, done\nnode_modules/.pnpm/registry.npmjs.org/integer/2.1.0/node_modules/integer: Running install script, done in 2s\nnode_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3: Running install script, failed in 393ms\n.../5.4.3/node_modules/better-sqlite3 install$ node-gyp rebuild\n│ gyp info it worked if it ends with ok\n│ gyp info using node-gyp@6.0.0\n│ gyp info using node@12.13.0 | linux | x64\n│ gyp info find Python using Python version 3.6.8 found at &quot;/usr/bin/python3&quot;\n│ gyp info spawn /usr/bin/python3\n│ gyp info spawn args [\n│ gyp info spawn args   '/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/gyp_main.py',\n│ gyp info spawn args   'binding.gyp',\n│ gyp info spawn args   '-f',\n│ gyp info spawn args   'make',\n│ gyp info spawn args   '-I',\n│ gyp info spawn args   '/root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3/build/config.gypi',\n│ gyp info spawn args   '-I',\n│ gyp info spawn args   '/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/addon.gypi',\n│ gyp info spawn args   '-I',\n│ gyp info spawn args   '/root/.cache/node-gyp/12.13.0/include/node/common.gypi',\n│ gyp info spawn args   '-Dlibrary=shared_library',\n│ gyp info spawn args   '-Dvisibility=default',\n│ gyp info spawn args   '-Dnode_root_dir=/root/.cache/node-gyp/12.13.0',\n│ gyp info spawn args   '-Dnode_gyp_dir=/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp',\n│ gyp info spawn args   '-Dnode_lib_file=/root/.cache/node-gyp/12.13.0/&lt;(target_arch)/node.lib',\n│ gyp info spawn args   '-Dmodule_root_dir=/root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3',\n│ gyp info spawn args   '-Dnode_engine=v8',\n│ gyp info spawn args   '--depth=.',\n│ gyp info spawn args   '--no-parallel',\n│ gyp info spawn args   '--generator-output',\n│ gyp info spawn args   'build',\n│ gyp info spawn args   '-Goutput_dir=.'\n│ gyp info spawn args ]\n│ Traceback (most recent call last):\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/gyp_main.py&quot;, line 50, in &lt;module&gt;\n│     sys.exit(gyp.script_main())\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py&quot;, line 554, in script_main\n│     return main(sys.argv[1:])\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py&quot;, line 547, in main\n│     return gyp_main(args)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py&quot;, line 532, in gyp_main\n│     generator.GenerateOutput(flat_list, targets, data, params)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py&quot;, line 2215, in GenerateOutput\n│     part_of_all=qualified_target in needed_targets)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py&quot;, line 794, in Write\n│     extra_mac_bundle_resources, part_of_all)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py&quot;, line 978, in WriteActions\n│     part_of_all=part_of_all, command=name)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py&quot;, line 1724, in WriteDoCmd\n│     force = True)\n│   File &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py&quot;, line 1779, in WriteMakeRule\n│     cmddigest = hashlib.sha1(command if command else self.target).hexdigest()\n│ TypeError: Unicode-objects must be encoded before hashing\n│ gyp ERR! configure error\n│ gyp ERR! stack Error: `gyp` failed with exit code: 1\n│ gyp ERR! stack     at ChildProcess.onCpExit (/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/lib/configure.js:351:16)\n│ gyp ERR! stack     at ChildProcess.emit (events.js:210:5)\n│ gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:272:12)\n│ gyp ERR! System Linux 4.15.0-33-generic\n│ gyp ERR! command &quot;/usr/bin/node&quot; &quot;/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/bin/node-gyp.js&quot; &quot;rebuild&quot;\n│ gyp ERR! cwd /root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3\n│ gyp ERR! node -v v12.13.0\n│ gyp ERR! node-gyp -v v6.0.0\n│ gyp ERR! not ok\n└─ Failed in 393ms\n ERROR  Command failed with exit code 1.\"><pre><span class=\"pl-c\"><span class=\"pl-c\">#</span> pnpm i better-sqlite3</span>\nPackages: +11\n+++++++++++\nResolving: total 11, reused 11, downloaded 0, <span class=\"pl-k\">done</span>\nnode_modules/.pnpm/registry.npmjs.org/integer/2.1.0/node_modules/integer: Running install script, <span class=\"pl-k\">done</span> <span class=\"pl-k\">in</span> 2s\nnode_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3: Running install script, failed <span class=\"pl-k\">in</span> 393ms\n.../5.4.3/node_modules/better-sqlite3 install$ node-gyp rebuild\n│ gyp info it worked <span class=\"pl-k\">if</span> it ends with ok\n│ gyp info using node-gyp@6.0.0\n│ gyp info using node@12.13.0 <span class=\"pl-k\">|</span> linux <span class=\"pl-k\">|</span> x64\n│ gyp info find Python using Python version 3.6.8 found at <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/bin/python3<span class=\"pl-pds\">\"</span></span>\n│ gyp info spawn /usr/bin/python3\n│ gyp info spawn args [\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/gyp_main.py<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>binding.gyp<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-f<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>make<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-I<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3/build/config.gypi<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-I<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/addon.gypi<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-I<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>/root/.cache/node-gyp/12.13.0/include/node/common.gypi<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dlibrary=shared_library<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dvisibility=default<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dnode_root_dir=/root/.cache/node-gyp/12.13.0<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dnode_gyp_dir=/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dnode_lib_file=/root/.cache/node-gyp/12.13.0/&lt;(target_arch)/node.lib<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dmodule_root_dir=/root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Dnode_engine=v8<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>--depth=.<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>--no-parallel<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>--generator-output<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>build<span class=\"pl-pds\">'</span></span>,\n│ gyp info spawn args   <span class=\"pl-s\"><span class=\"pl-pds\">'</span>-Goutput_dir=.<span class=\"pl-pds\">'</span></span>\n│ gyp info spawn args ]\n│ Traceback (most recent call last):\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/gyp_main.py<span class=\"pl-pds\">\"</span></span>, line 50, <span class=\"pl-k\">in</span> <span class=\"pl-k\">&lt;</span>module<span class=\"pl-k\">&gt;</span>\n│     <span class=\"pl-en\">sys.exit(gyp.script_main</span>())\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py<span class=\"pl-pds\">\"</span></span>, line 554, <span class=\"pl-k\">in</span> script_main\n│     <span class=\"pl-k\">return</span> main(sys.argv[1:])\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py<span class=\"pl-pds\">\"</span></span>, line 547, <span class=\"pl-k\">in</span> main\n│     <span class=\"pl-k\">return</span> gyp_main(args)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/__init__.py<span class=\"pl-pds\">\"</span></span>, line 532, <span class=\"pl-k\">in</span> gyp_main\n│     generator.GenerateOutput(flat_list, targets, data, params)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py<span class=\"pl-pds\">\"</span></span>, line 2215, <span class=\"pl-k\">in</span> GenerateOutput\n│     part_of_all=qualified_target <span class=\"pl-k\">in</span> needed_targets)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py<span class=\"pl-pds\">\"</span></span>, line 794, <span class=\"pl-k\">in</span> Write\n│     extra_mac_bundle_resources, part_of_all)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py<span class=\"pl-pds\">\"</span></span>, line 978, <span class=\"pl-k\">in</span> WriteActions\n│     part_of_all=part_of_all, command=name)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py<span class=\"pl-pds\">\"</span></span>, line 1724, <span class=\"pl-k\">in</span> WriteDoCmd\n│     force = True)\n│   File <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/gyp/pylib/gyp/generator/make.py<span class=\"pl-pds\">\"</span></span>, line 1779, <span class=\"pl-k\">in</span> WriteMakeRule\n│     cmddigest = hashlib.sha1(command <span class=\"pl-k\">if</span> <span class=\"pl-c1\">command</span> <span class=\"pl-k\">else</span> <span class=\"pl-en\">self.target).hexdigest</span>()\n│ TypeError: Unicode-objects must be encoded before hashing\n│ gyp ERR<span class=\"pl-k\">!</span> configure error\n│ gyp ERR<span class=\"pl-k\">!</span> stack Error: <span class=\"pl-s\"><span class=\"pl-pds\">`</span>gyp<span class=\"pl-pds\">`</span></span> failed with <span class=\"pl-c1\">exit</span> code: 1\n│ gyp ERR<span class=\"pl-k\">!</span> stack     at ChildProcess.onCpExit (/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/lib/configure.js:351:16)\n│ gyp ERR<span class=\"pl-k\">!</span> stack     at ChildProcess.emit (events.js:210:5)\n│ gyp ERR<span class=\"pl-k\">!</span> stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:272:12)\n│ gyp ERR<span class=\"pl-k\">!</span> System Linux 4.15.0-33-generic\n│ gyp ERR<span class=\"pl-k\">!</span> <span class=\"pl-c1\">command</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/bin/node<span class=\"pl-pds\">\"</span></span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/usr/lib/node_modules/pnpm/lib/node_modules/node-gyp/bin/node-gyp.js<span class=\"pl-pds\">\"</span></span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>rebuild<span class=\"pl-pds\">\"</span></span>\n│ gyp ERR<span class=\"pl-k\">!</span> cwd /root/2/node_modules/.pnpm/registry.npmjs.org/better-sqlite3/5.4.3/node_modules/better-sqlite3\n│ gyp ERR<span class=\"pl-k\">!</span> node -v v12.13.0\n│ gyp ERR<span class=\"pl-k\">!</span> node-gyp -v v6.0.0\n│ gyp ERR<span class=\"pl-k\">!</span> not ok\n└─ Failed <span class=\"pl-k\">in</span> 393ms\n ERROR  Command failed with <span class=\"pl-c1\">exit</span> code 1.</pre></div>\n<ul dir=\"auto\">\n<li>问题分析: 会不会是 c++ 版本的问题？而得到的信息为该镜像使用 yarn 却是好的! 最终换了同一个 Node.js 版本的镜像又好了，辗转反侧才在 pnpm 的 issue 中找到真正的原因，为 pnpm 低版本的 bug。</li>\n</ul>\n<h3 dir=\"auto\">同一个版本的包有两份副本</h3>\n<ul dir=\"auto\">\n<li>问题描述: 同一个版本的包在 .pnpm 目录下却有两份副本</li>\n<li>问题解决: 添加 .pnpmfile.cjs 文件，忽略 peerDependencies，使其对 peer 的处理与 yarn 保持一致</li>\n</ul>\n<div class=\"highlight highlight-source-js position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"// .pnpmfile.cjs\n\nfunction readPackage(pkg, context) {\n  if (pkg.name &amp;&amp; pkg.peerDependencies) {\n    // https://pnpm.io/zh/how-peers-are-resolved\n    pkg.peerDependencies = {}\n  }\n\n  return pkg\n}\n\nmodule.exports = {\n  hooks: {\n    readPackage,\n  },\n}\n\"><pre><span class=\"pl-c\">// .pnpmfile.cjs</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">readPackage</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">context</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">peerDependencies</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c\">// https://pnpm.io/zh/how-peers-are-resolved</span>\n    <span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">peerDependencies</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">pkg</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-smi\">module</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">exports</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c1\">hooks</span>: <span class=\"pl-kos\">{</span>\n    readPackage<span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<ul dir=\"auto\">\n<li>报错信息:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/23253540/143979554-083009de-e027-461a-aa85-1c982491e043.png\"><img src=\"https://user-images.githubusercontent.com/23253540/143979554-083009de-e027-461a-aa85-1c982491e043.png\" alt=\"img\" style=\"max-width: 100%;\"></a></li>\n<li>问题分析: 这个问题困扰了很久，后仔细阅读了 pnpm 的 <a href=\"https://www.pnpm.cn/how-peers-are-resolved\" rel=\"nofollow\">How peers are resolved</a> 文档，确认了造成的原因。详细的讨论可见: <a href=\"https://github.com/pnpm/pnpm/discussions/4051\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/pnpm/pnpm/discussions/4051/hovercard\">discussions/4051</a></li>\n</ul>\n<h3 dir=\"auto\">only-allow 命令影响到了业务项目</h3>\n<ul dir=\"auto\">\n<li>问题描叙: 当你在一个公共包的项目中添加了 preinstall 的勾子，但是实际依赖该包的业务并未使用 pnpm，造成报错</li>\n<li>问题解决: only-allow 当作为依赖时不应该进行检查，暂时使用支持了该功能的 only-allow-test 包代替。对应的讨论见 : <a href=\"https://github.com/pnpm/pnpm/discussions/4131\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/pnpm/pnpm/discussions/4131/hovercard\">discussions/4131</a></li>\n</ul>\n<div class=\"highlight highlight-source-json position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n    &quot;scripts&quot;: {\n        &quot;preinstall&quot;: &quot;npx only-allow pnpm&quot;\n    }\n}\"><pre>{\n    <span class=\"pl-ent\">\"scripts\"</span>: {\n        <span class=\"pl-ent\">\"preinstall\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>npx only-allow pnpm<span class=\"pl-pds\">\"</span></span>\n    }\n}</pre></div>\n<h2 dir=\"auto\"><g-emoji class=\"g-emoji\" alias=\"x\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/274c.png\">❌</g-emoji> 未解决的问题</h2>\n<h3 dir=\"auto\">pnpm add 与 pnpm i 命令不会去重</h3>\n<ul dir=\"auto\">\n<li>问题描叙: 当使用 pnpm add 或者 pnpm i 升级某个包时，会存在某几个版本兼容的包没有进行合并，导致存在多个版本。如 sass: ^1.30.0 和 sass: '^1.44.0'没有被合并，但是使用 pnpm update 去升级这个包是会进行合并</li>\n<li>问题分析: 由于使用 yarn 的习惯不小心就会发生这种情况，所以希望支持 pnpm deduplicate 去重的命令，每次构建前强制运行一次，反馈后作者表示 pnpm add 命令会保持和 update 命令同样的行为。对应的讨论见 <a href=\"https://github.com/pnpm/pnpm/discussions/4143\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/pnpm/pnpm/discussions/4143/hovercard\">discussions/4143</a></li>\n<li>临时解决: 找到了一个 pnpm update / install / add 命令后都会运行的一个勾子，在其中写了一个自定义的校验函数，如果pkgName 存在 dependencies 或者 devDependencies 中，就只能使用 pnpm update 命令去更新升级</li>\n</ul>\n<div class=\"highlight highlight-source-js position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"// .pnpmfile.cjs\n\nconst argv = process.argv.slice(2)\n\nfunction readPackage(pkg, context) {\n  // Override the manifest of foo@1.x after downloading it from the registry\n  if (pkg.name &amp;&amp; pkg.peerDependencies) {\n    // Replace bar@x.x.x with bar@2.0.0\n    pkg.peerDependencies = {}\n  }\n\n  return pkg\n}\n\nfunction checkCommand() {\n  const command = argv[0]\n  const pkgJson = require('./package.json')\n  const deps = Object.assign({}, pkgJson.dependencies || {}, pkgJson.devDependencies || {})\n\n  if (['add', 'i', 'install'].some((name) =&gt; command === name) &amp;&amp; typeof argv[1] === 'string') {\n    const { name, version } = getNameAndVersion(argv[1])\n\n    if (deps[name]) {\n      throw new Error(\n        `【Inspector 依赖检查】: 更新升级依赖请用 &quot;pnpm update ${name}${\n          version ? '@' + version : ''\n        }&quot; 命令 !!!`\n      )\n    }\n  }\n}\n\nfunction getNameAndVersion(nameAndVersion) {\n  let name = ''\n  let version = ''\n  let splitName = nameAndVersion.split('@')\n\n  if (nameAndVersion.startsWith('@')) {\n    // @xxxx/pkg@latest or @xxxx/pkg\n\n    if (splitName.length === 3) {\n      // @xxxx/pkg@latest\n      name = `@` + splitName[1]\n      version = splitName[splitName.length - 1]\n    } else {\n      // @xxxx/pkg\n      name = `@` + splitName[1]\n      version = ''\n    }\n  } else {\n    // react@latest or react\n    if (splitName.length === 2) {\n      // @xxxx/pkg@latest\n      name = splitName[0]\n      version = splitName[1]\n    } else {\n      // @xxxx/pkg\n      name = splitName[0]\n      version = ''\n    }\n  }\n  return {\n    name,\n    version: version || 'latest',\n  }\n}\n\nmodule.exports = {\n  hooks: {\n    readPackage,\n    afterAllResolved(lockfile) {\n      checkCommand()\n      return lockfile\n    },\n  },\n}\n\"><pre><span class=\"pl-c\">// .pnpmfile.cjs</span>\n\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">argv</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">process</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">argv</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">slice</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">readPackage</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">context</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c\">// Override the manifest of foo@1.x after downloading it from the registry</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">name</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">peerDependencies</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c\">// Replace bar<span class=\"pl-k\">@x</span>.x.x with bar@2.0.0</span>\n    <span class=\"pl-s1\">pkg</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">peerDependencies</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-k\">return</span> <span class=\"pl-s1\">pkg</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">checkCommand</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">command</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">argv</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">]</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">pkgJson</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">require</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'./package.json'</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">deps</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">assign</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">pkgJson</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">dependencies</span> <span class=\"pl-c1\">||</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">pkgJson</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">devDependencies</span> <span class=\"pl-c1\">||</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">'add'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'i'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'install'</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">some</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-s1\">command</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">&amp;&amp;</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">argv</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">===</span> <span class=\"pl-s\">'string'</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-k\">const</span> <span class=\"pl-kos\">{</span> name<span class=\"pl-kos\">,</span> version <span class=\"pl-kos\">}</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">getNameAndVersion</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">argv</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">deps</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Error</span><span class=\"pl-kos\">(</span>\n        <span class=\"pl-s\">`【Inspector 依赖检查】: 更新升级依赖请用 \"pnpm update <span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">}</span></span><span class=\"pl-s1\"><span class=\"pl-kos\">${</span></span></span>\n<span class=\"pl-s\"><span class=\"pl-s1\">          <span class=\"pl-s1\">version</span> ? <span class=\"pl-s\">'@'</span> <span class=\"pl-c1\">+</span> <span class=\"pl-s1\">version</span> : <span class=\"pl-s\">''</span></span></span>\n<span class=\"pl-s\"><span class=\"pl-s1\">        <span class=\"pl-kos\">}</span></span>\" 命令 !!!`</span>\n      <span class=\"pl-kos\">)</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-k\">function</span> <span class=\"pl-en\">getNameAndVersion</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">nameAndVersion</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">''</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">''</span>\n  <span class=\"pl-k\">let</span> <span class=\"pl-s1\">splitName</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">nameAndVersion</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">split</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'@'</span><span class=\"pl-kos\">)</span>\n\n  <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">nameAndVersion</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">startsWith</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'@'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c\">// <span class=\"pl-k\">@xxxx</span>/pkg<span class=\"pl-k\">@latest</span> or @xxxx/pkg</span>\n\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span> <span class=\"pl-c1\">===</span> <span class=\"pl-c1\">3</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-c\">// <span class=\"pl-k\">@xxxx</span>/pkg<span class=\"pl-k\">@latest</span></span>\n      <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">`@`</span> <span class=\"pl-c1\">+</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span>\n      <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span> <span class=\"pl-c1\">-</span> <span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">}</span> <span class=\"pl-k\">else</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-c\">// <span class=\"pl-k\">@xxxx</span>/pkg</span>\n      <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">`@`</span> <span class=\"pl-c1\">+</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span>\n      <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">''</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span> <span class=\"pl-k\">else</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c\">// react<span class=\"pl-k\">@latest</span> or react</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span> <span class=\"pl-c1\">===</span> <span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-c\">// <span class=\"pl-k\">@xxxx</span>/pkg<span class=\"pl-k\">@latest</span></span>\n      <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">]</span>\n      <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">}</span> <span class=\"pl-k\">else</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-c\">// <span class=\"pl-k\">@xxxx</span>/pkg</span>\n      <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">splitName</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">]</span>\n      <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">''</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">return</span> <span class=\"pl-kos\">{</span>\n    name<span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">version</span>: <span class=\"pl-s1\">version</span> <span class=\"pl-c1\">||</span> <span class=\"pl-s\">'latest'</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-smi\">module</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">exports</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-c1\">hooks</span>: <span class=\"pl-kos\">{</span>\n    readPackage<span class=\"pl-kos\">,</span>\n    <span class=\"pl-en\">afterAllResolved</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">lockfile</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span>\n      <span class=\"pl-en\">checkCommand</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span>\n      <span class=\"pl-k\">return</span> <span class=\"pl-s1\">lockfile</span>\n    <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<h3 dir=\"auto\">cypress e2e 测试运行失败</h3>\n<ul dir=\"auto\">\n<li>问题描叙: 使用 pnpm 后，原有的 cypress e2e 测试失败了</li>\n<li>问题分析: 经过 debug 发现 cypress 还不支持 pnpm, 于是提了一个 <a href=\"https://github.com/cypress-io/cypress/pull/19189\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/cypress-io/cypress/pull/19189/hovercard\">pr</a>，cypress 处理跟进较慢，还未解决</li>\n</ul>",
            "url": "https://github.com/xiaoxiaojx/blog/issues/23",
            "title": "pnpm 问题记录",
            "date_modified": "2022-01-11T11:54:36.000Z",
            "date_published": "2021-12-19T14:39:30.000Z",
            "author": {
                "name": "xiaoxiaojx",
                "url": "https://github.com/xiaoxiaojx"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/810398?u=d8067c4f8624dbdd9eec964cb62059cacafefe42&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Bringing this over from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"3621633\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/feedback/discussions/582\" data-hovercard-type=\"discussion\" data-hovercard-url=\"/npm/feedback/discussions/582/hovercard\" href=\"https://github.com/npm/feedback/discussions/582\">npm/feedback#582</a> per <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/MylesBorins/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/MylesBorins\">@MylesBorins</a> direction (also, hi Myles!)</p>\n<hr>\n<p dir=\"auto\">Following up on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1006655131\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/463\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/463/hovercard\" href=\"https://github.com/npm/rfcs/issues/463\">#463</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1018532506\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/470\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/470/hovercard\" href=\"https://github.com/npm/rfcs/issues/470\">#470</a> (and the <a href=\"https://github.com/npm/rfcs/blob/main/meetings/2021-10-06.md\">meeting notes here</a>) … I'm a little unclear on the status of what's left to do here. I'm willing to help if I can!</p>\n<p dir=\"auto\">There were a few action items created as part of that meeting:</p>\n<blockquote>\n<p dir=\"auto\"><strong>Actions:</strong></p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> land npm-packlist in cli (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/wraithgar/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/wraithgar\">@wraithgar</a>)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> RFC about running prepare scripts for linked bundled deps</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> RFC about workspace layout (<a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/ljharb/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ljharb\">@ljharb</a>)</li>\n</ul>\n</blockquote>\n<p dir=\"auto\">Taking the second action item first, is that something I should take on? I think it might be blocked by the first item on the list because right now the suggested workaround (below) isn't working with npm@8 or npm@7 … yet?</p>\n<blockquote>\n<div class=\"highlight highlight-source-json position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n  &quot;name&quot;: &quot;lambda-a&quot;,\n  &quot;dependencies&quot;: {\n    &quot;b&quot;: &quot;file:../b&quot;\n  },\n  &quot;bundleDependencies&quot;: [\n    &quot;b&quot;\n  ],\n  &quot;scripts&quot;: {\n    &quot;prepare&quot;: &quot;cd ../b; npm run prepare&quot;\n  }\n}\"><pre>{\n  <span class=\"pl-ent\">\"name\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>lambda-a<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-ent\">\"dependencies\"</span>: {\n    <span class=\"pl-ent\">\"b\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file:../b<span class=\"pl-pds\">\"</span></span>\n  },\n  <span class=\"pl-ent\">\"bundleDependencies\"</span>: [\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>b<span class=\"pl-pds\">\"</span></span>\n  ],\n  <span class=\"pl-ent\">\"scripts\"</span>: {\n    <span class=\"pl-ent\">\"prepare\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>cd ../b; npm run prepare<span class=\"pl-pds\">\"</span></span>\n  }\n}</pre></div>\n</blockquote>\n<p dir=\"auto\">Is there any eta on landing npm-packlist in the cli? I've created a demo repo <a href=\"https://github.com/mysterycommand/multi-app-monorepo\">here</a> to test out the workaround and see if I could come up with a \"hacky\" implementation of running prepare scripts on local bundled deps, but currently when I run <code>npm pack --dry-run --json -w apps/app-a</code> in that repo, I get this output:</p>\n<div class=\"highlight highlight-source-json position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"[\n  {\n    &quot;id&quot;: &quot;@multi-app-monorepo/app-a@1.0.0&quot;,\n    &quot;name&quot;: &quot;@multi-app-monorepo/app-a&quot;,\n    &quot;version&quot;: &quot;1.0.0&quot;,\n    &quot;size&quot;: 500,\n    &quot;unpackedSize&quot;: 838,\n    &quot;shasum&quot;: &quot;4bd38bbbcc89e412082d48ef45849e53a3512f92&quot;,\n    &quot;integrity&quot;: &quot;sha512-+sHhXSMqS8BCZjuirZwAs2rgs1UU2O+mr+nGlBYSQadIWV9nSNA8NAhO6QW2IUYS6XM5TT5+uSQ2k03Y7+FaWg==&quot;,\n    &quot;filename&quot;: &quot;@multi-app-monorepo/app-a-1.0.0.tgz&quot;,\n    &quot;files&quot;: [\n      {\n        &quot;path&quot;: &quot;index.js&quot;,\n        &quot;size&quot;: 133,\n        &quot;mode&quot;: 420\n      },\n      {\n        &quot;path&quot;: &quot;package.json&quot;,\n        &quot;size&quot;: 705,\n        &quot;mode&quot;: 420\n      }\n    ],\n    &quot;entryCount&quot;: 2,\n    &quot;bundled&quot;: []\n  }\n]\"><pre>[\n  {\n    <span class=\"pl-ent\">\"id\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@multi-app-monorepo/app-a@1.0.0<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"name\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@multi-app-monorepo/app-a<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"version\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1.0.0<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"size\"</span>: <span class=\"pl-c1\">500</span>,\n    <span class=\"pl-ent\">\"unpackedSize\"</span>: <span class=\"pl-c1\">838</span>,\n    <span class=\"pl-ent\">\"shasum\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>4bd38bbbcc89e412082d48ef45849e53a3512f92<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"integrity\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>sha512-+sHhXSMqS8BCZjuirZwAs2rgs1UU2O+mr+nGlBYSQadIWV9nSNA8NAhO6QW2IUYS6XM5TT5+uSQ2k03Y7+FaWg==<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"filename\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@multi-app-monorepo/app-a-1.0.0.tgz<span class=\"pl-pds\">\"</span></span>,\n    <span class=\"pl-ent\">\"files\"</span>: [\n      {\n        <span class=\"pl-ent\">\"path\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>index.js<span class=\"pl-pds\">\"</span></span>,\n        <span class=\"pl-ent\">\"size\"</span>: <span class=\"pl-c1\">133</span>,\n        <span class=\"pl-ent\">\"mode\"</span>: <span class=\"pl-c1\">420</span>\n      },\n      {\n        <span class=\"pl-ent\">\"path\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>package.json<span class=\"pl-pds\">\"</span></span>,\n        <span class=\"pl-ent\">\"size\"</span>: <span class=\"pl-c1\">705</span>,\n        <span class=\"pl-ent\">\"mode\"</span>: <span class=\"pl-c1\">420</span>\n      }\n    ],\n    <span class=\"pl-ent\">\"entryCount\"</span>: <span class=\"pl-c1\">2</span>,\n    <span class=\"pl-ent\">\"bundled\"</span>: []\n  }\n]</pre></div>\n<p dir=\"auto\">I'd expect the package.json and index.js from pkgs/pkg-c to show up in the packed output of app-a (maybe under that <code>\"bundled\"</code> key?) … indeed I believe this is the point of the npm-packlist action item. Just wanting to make sure I'm not missing something.</p>\n<p dir=\"auto\">cc/ <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/isaacs/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/isaacs\">@isaacs</a> who offered the workaround at the meeting and might have some ideas? <g-emoji class=\"g-emoji\" alias=\"crossed_fingers\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f91e.png\">🤞</g-emoji></p>",
            "url": "https://github.com/npm/rfcs/issues/477",
            "title": "Multi-app Monorepo Followup",
            "date_modified": "2021-11-03T14:06:00.000Z",
            "date_published": "2021-10-15T02:26:30.000Z",
            "author": {
                "name": "mysterycommand",
                "url": "https://github.com/mysterycommand"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/220900?u=d3ebd1dff5ce1b0dbd54cfece7dd3a01b0db7311&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Motivation (\"The Why\")</h2>\n<p dir=\"auto\">Users are often confused by the fact that <code>npm install</code> (no args) and <code>npm install &lt;pkg&gt;</code> have <a href=\"https://github.com/npm/cli/blob/33a31a97eb3f14d8a4b6b681e51d44056fd9a3c1/lib/install.js#L152\">different behavior with regards to lifecycle scripts</a>, updating the package-lock file and other possible nuances in arborist when adding new deps to the installed tree vs simply reifying a tree.</p>\n<p dir=\"auto\">The lifecycle script discussion has happened to some extent already over at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"810277318\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/325\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/325/hovercard\" href=\"https://github.com/npm/rfcs/issues/325\">#325</a> and although there's some level of agreement on having it work with a new type of lifecycle script (such as a generic tree mutation event) I would like to propose an alternative that at the same time also aims to improve the UX around adding new dependencies to a project.</p>\n<h3 dir=\"auto\">How</h3>\n<p dir=\"auto\">We currently have a <code>npm add</code> command that is <a href=\"https://github.com/npm/cli/blob/33a31a97eb3f14d8a4b6b681e51d44056fd9a3c1/docs/content/commands/npm-install.md#synopsis\">lightly documented</a> and works as <a href=\"https://github.com/npm/cli/blob/33a31a97eb3f14d8a4b6b681e51d44056fd9a3c1/lib/utils/cmd-list.js#L54\">an alias to <code>npm install</code></a>. The main idea to be proposed in an eventual RFC is to turn <code>npm add</code> into an actual top-level command (with its own docs page and associated tests) along with adding custom behavior to run new <code>preadd</code>, <code>add</code> and <code>postadd</code> lifecycle scripts.</p>\n<p dir=\"auto\">This aims to improve some of the existing pain points:</p>\n<ul dir=\"auto\">\n<li>Add a way to run scripts after adding a new dependency (solves <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"810277318\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/325\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/325/hovercard\" href=\"https://github.com/npm/rfcs/issues/325\">#325</a>)</li>\n<li>A more expressive syntax. Users are going to be aware that they're adding (and thus mutating the current installed tree) when using a different top-level command.</li>\n</ul>\n<h4 dir=\"auto\">Desired Behaviour</h4>\n<p dir=\"auto\">Given a project with the following package.json:</p>\n<div class=\"highlight highlight-source-json position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n  &quot;name&quot;: &quot;project&quot;,\n  &quot;version&quot;: &quot;1.0.0&quot;,\n  &quot;scripts&quot;: {\n    &quot;preadd&quot;: &quot;echo \\&quot;Ran prior to adding a new dep\\&quot;&quot;\n  }\n}\"><pre>{\n  <span class=\"pl-ent\">\"name\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>project<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-ent\">\"version\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1.0.0<span class=\"pl-pds\">\"</span></span>,\n  <span class=\"pl-ent\">\"scripts\"</span>: {\n    <span class=\"pl-ent\">\"preadd\"</span>: <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>echo <span class=\"pl-cce\">\\\"</span>Ran prior to adding a new dep<span class=\"pl-cce\">\\\"</span><span class=\"pl-pds\">\"</span></span>\n  }\n}</pre></div>\n<p dir=\"auto\">When adding a new dependency using <code>npm add &lt;pkg&gt;</code> the lifecycle script would be executed, e.g:</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ npm add abbrev\n\n&gt; project@1.0.0 preadd\n&gt; echo &quot;Ran prior to adding a new dep&quot;\n\nRan prior to adding a new dep\n\nadded 1 package, and audited 2 packages in 584ms\n\nfound 0 vulnerabilities\"><pre><code>$ npm add abbrev\n\n&gt; project@1.0.0 preadd\n&gt; echo \"Ran prior to adding a new dep\"\n\nRan prior to adding a new dep\n\nadded 1 package, and audited 2 packages in 584ms\n\nfound 0 vulnerabilities\n</code></pre></div>\n<h3 dir=\"auto\">References</h3>\n<ul dir=\"auto\">\n<li>Related to: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"810277318\" data-permission-text=\"Title is private\" data-url=\"https://github.com/npm/rfcs/issues/325\" data-hovercard-type=\"issue\" data-hovercard-url=\"/npm/rfcs/issues/325/hovercard\" href=\"https://github.com/npm/rfcs/issues/325\">#325</a></li>\n</ul>\n<p dir=\"auto\">cc <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/karlhorky/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/karlhorky\">@karlhorky</a> <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/wraithgar/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/wraithgar\">@wraithgar</a></p>",
            "url": "https://github.com/npm/rfcs/issues/395",
            "title": "[RRFC] Promote `npm add` to a top-level command",
            "date_modified": "2021-06-21T01:46:42.000Z",
            "date_published": "2021-06-08T21:52:09.000Z",
            "author": {
                "name": "ruyadorno",
                "url": "https://github.com/ruyadorno"
            }
        }
    ]
}